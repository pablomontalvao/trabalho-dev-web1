<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Área do Administrador</title>
  <link rel="stylesheet" href="../css/areaAdm.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    
</head>

<body>
  <header class="header">
    <div class="container header__content">
      <div class="header__brand">
        <img class="header__logo"  src="../imagem/RAUlogobranca.png" alt="Logo" />
      </div>
      <nav class="header__nav" aria-label="Principal">
        <a href="index.html" class="nav__link">HOME</a>
        <a href="sobre.html" class="nav__link">SOBRE NÓS</a>
      </nav>
      <div class="header__user">
        <span class="user__name">Adm123</span>
        <a class="btn btn--ghost" href="#sair">SAIR</a>
      </div>
    </div>
  </header>

  <main class="page">
    <section class="section">
      <div class="container">
        <h1 class="section__title">Reclamações recebidas:</h1>

        <div class="filters" role="region" aria-label="Filtros">

          <div class="filters__row">
            <div class="filters__title-container">
              <h3 class="filters__title">Filtros</h3>
              <div class="filters__divider"></div>
            </div>

            <div class="field">
              <label for="f-status">Status:</label>
              <select id="f-status">
                <option value="">Todos</option>
                <option value="recebido">Recebido</option>
                <option value="andamento">Em andamento</option>
                <option value="resolvido">Resolvido</option>
              </select>
            </div>

            <div class="field field--wide">
              <label for="f-endereco">Endereço:</label>
              <input id="f-endereco" type="text" />
            </div>

            <div class="field">
              <label for="f-tipo">Tipo:</label>
              <select id="f-tipo">
                <option value="">Todos</option>
                <option>Falta de água</option>
                <option>Água suja/com cheiro</option>
                <option>Vazamento de água limpa</option>
                <option>Vazamento de esgoto</option>
                <option>Despejo irregular</option>
                <option>Outros</option>
              </select>
            </div>
          

            <div class="field field--dates">
              <label>Data:</label>
              <div class="date-range">
                <div class="date-input-wrapper">
                  <input type="date" id="f-data-inicio" aria-label="Data início" />
                </div>
                <div class="date-input-wrapper">
                  <input type="date" id="f-data-fim" aria-label="Data fim" />
                </div>
              </div>
            </div>

            <button id="clear-filters-btn" class="btn btn--ghost" type="button">Limpar Filtros</button>
          </div>

          <ul class="cards" id="claims-list" aria-live="polite">
            <li class="card" data-id="1" data-status="recebido" data-tipo="Iluminação"
              data-endereco="Rua das Flores, 123 - Centro" data-data="12/08/2025" data-hora="14:30"
              data-descricao="Poste sem iluminação em frente ao número 123." data-numero="123"
              data-complemento="Centro">
              <div class="card__status">
                <span class="status__label">Status</span>
                <img class="status__icon" src="../imagem/checkRecebido.png" alt="Recebido" />
                <span class="status__text status--recebido">Recebido</span>
              </div>
              <div class="card__body">
                <div class="card__grid">
                  <div class="card__col"><span class="label">Tipo:</span><span class="value">Iluminação</span></div>
                  <div class="card__col"><span class="label">Endereço:</span><span class="value">Rua das Flores, 123 -
                      Centro</span></div>
                  <div class="card__col"><span class="label">Data:</span><span class="value">12/08/2025</span></div>
                  <div class="card__col"><span class="label">Hora:</span><span class="value">14:30</span></div>
                  <div class="card__col card__col--full"><span class="label">Descrição:</span><span class="value">Poste
                      sem iluminação em frente ao número 123.</span></div>
                </div>
                <div class="card__actions">
                  <button class="btn btn--primary btn--small" onclick="viewDetails(1)">Ver Detalhes</button>
                  <button class="btn btn--secondary btn--small" onclick="updateStatus(1)">Atualizar Status</button>
                </div>
              </div>
            </li>

            <li class="card" data-id="2" data-status="andamento" data-tipo="Lixo"
              data-endereco="Av. Brasil, 456 - Jardim" data-data="10/08/2025" data-hora="09:15"
              data-descricao="Acúmulo de lixo não recolhido há três dias." data-numero="456" data-complemento="Jardim">
              <div class="card__status">
                <span class="status__label">Status</span>
                <img class="status__icon" src="../imagem/checkEmAndamento.png" alt="Em andamento" />
                <span class="status__text status--andamento">Em andamento</span>
              </div>
              <div class="card__body">
                <div class="card__grid">
                  <div class="card__col"><span class="label">Tipo:</span><span class="value">Lixo</span></div>
                  <div class="card__col"><span class="label">Endereço:</span><span class="value">Av. Brasil, 456 -
                      Jardim</span></div>
                  <div class="card__col"><span class="label">Data:</span><span class="value">10/08/2025</span></div>
                  <div class="card__col"><span class="label">Hora:</span><span class="value">09:15</span></div>
                  <div class="card__col card__col--full"><span class="label">Descrição:</span><span
                      class="value">Acúmulo de lixo não recolhido há três dias.</span></div>
                </div>
                <div class="card__actions">
                  <button class="btn btn--primary btn--small" onclick="viewDetails(2)">Ver Detalhes</button>
                  <button class="btn btn--secondary btn--small" onclick="updateStatus(2)">Atualizar Status</button>
                </div>
              </div>
            </li>

            <li class="card" data-id="3" data-status="resolvido" data-tipo="Buraco na via"
              data-endereco="Rua A, 789 - Industrial" data-data="03/08/2025" data-hora="16:45"
              data-descricao="Buraco grande próximo à esquina, já tapado." data-numero="789"
              data-complemento="Industrial">
              <div class="card__status">
                <span class="status__label">Status</span>
                <img class="status__icon" src="../imagem/checkResolvido.png" alt="Resolvido" />
                <span class="status__text status--resolvido">Resolvido</span>
              </div>
              <div class="card__body">
                <div class="card__grid">
                  <div class="card__col"><span class="label">Tipo:</span><span class="value">Buraco na via</span></div>
                  <div class="card__col"><span class="label">Endereço:</span><span class="value">Rua A, 789 -
                      Industrial</span></div>
                  <div class="card__col"><span class="label">Data:</span><span class="value">03/08/2025</span></div>
                  <div class="card__col"><span class="label">Hora:</span><span class="value">16:45</span></div>
                  <div class="card__col card__col--full"><span class="label">Descrição:</span><span class="value">Buraco
                      grande próximo à esquina, já tapado.</span></div>
                </div>
                <div class="card__actions">
                  <button class="btn btn--primary btn--small" onclick="viewDetails(3)">Ver Detalhes</button>
                  <button class="btn btn--secondary btn--small" onclick="updateStatus(3)">Atualizar Status</button>
                </div>
              </div>
            </li>

            <li class="card" data-id="4" data-status="andamento" data-tipo="Água/Esgoto"
              data-endereco="Rua B, 55 - Centro" data-data="01/08/2025" data-hora="11:20"
              data-descricao="Vazamento visível próximo à calçada." data-numero="55" data-complemento="Centro">
              <div class="card__status">
                <span class="status__label">Status</span>
                <img class="status__icon" src="../imagem/checkEmAndamento.png" alt="Em andamento" />
                <span class="status__text status--andamento">Em andamento</span>
              </div>
              <div class="card__body">
                <div class="card__grid">
                  <div class="card__col"><span class="label">Tipo:</span><span class="value">Água/Esgoto</span></div>
                  <div class="card__col"><span class="label">Endereço:</span><span class="value">Rua B, 55 -
                      Centro</span></div>
                  <div class="card__col"><span class="label">Data:</span><span class="value">01/08/2025</span></div>
                  <div class="card__col"><span class="label">Hora:</span><span class="value">11:20</span></div>
                  <div class="card__col card__col--full"><span class="label">Descrição:</span><span
                      class="value">Vazamento visível próximo à calçada.</span></div>
                </div>
                <div class="card__actions">
                  <button class="btn btn--primary btn--small" onclick="viewDetails(4)">Ver Detalhes</button>
                  <button class="btn btn--secondary btn--small" onclick="updateStatus(4)">Atualizar Status</button>
                </div>
              </div>
            </li>
          </ul>
          <p id="no-results-message" class="no-results" style="display: none;">Nenhuma reclamação encontrada com os filtros aplicados.</p>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal de Detalhes -->
  <div id="details-modal" class="modal">
    <div class="modal__content">
      <div class="modal__header">
        <h2 id="modal-title">Detalhes da Reclamação</h2>
        <button class="modal__close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal__body" id="modal-body">
        <!-- Conteúdo será preenchido dinamicamente -->
      </div>
    </div>
  </div>

  <!-- Modal de Atualização de Status -->
  <div id="status-modal" class="modal">
    <div class="modal__content">
      <div class="modal__header">
        <h2>Atualizar Status</h2>
        <button class="modal__close" onclick="closeStatusModal()">&times;</button>
      </div>
      <div class="modal__body">
        <form id="status-form">
          <div class="field">
            <label for="new-status">Novo Status:</label>
            <select id="new-status" name="new-status" required>
              <option value="recebido">Recebido</option>
              <option value="andamento">Em andamento</option>
              <option value="resolvido">Resolvido</option>
            </select>
          </div>
          <div class="field">
            <label for="status-notes">Observações (opcional):</label>
            <textarea id="status-notes" name="status-notes" rows="3"
              placeholder="Adicione observações sobre a mudança de status..."></textarea>
          </div>
          <div class="form__actions">
            <button type="button" class="btn btn--ghost" onclick="closeStatusModal()">Cancelar</button>
            <button type="submit" class="btn btn--primary">Atualizar</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <footer class="custom-footer text-center py-3 mt-auto w-100">
    <p>&copy; “Trabalho final DWEB – Grupo RAU"</p>
  </footer>

  <script>
    // Sistema de gerenciamento de reclamações para administradores
    class AdminComplaintManager {
      constructor() {
        this.complaints = [];
        this.currentComplaintId = null;
        this.init();
      }

      init() {
        console.log('Inicializando AdminComplaintManager...');
        this.setupFilters();
        this.loadExistingComplaints();
        this.setupStatusForm();
        console.log('AdminComplaintManager inicializado com', this.complaints.length, 'reclamações');
      }

      setupFilters() {
        const statusFilter = document.getElementById('f-status');
        const enderecoFilter = document.getElementById('f-endereco');
        const tipoFilter = document.getElementById('f-tipo');
        // Mude os seletores para os IDs que adicionamos
        const dataInicioFilter = document.getElementById('f-data-inicio');
        const dataFimFilter = document.getElementById('f-data-fim');
        const clearFiltersBtn = document.getElementById('clear-filters-btn'); // Pega o botão

        [statusFilter, enderecoFilter, tipoFilter, dataInicioFilter, dataFimFilter].forEach(filter => {
          if (filter) {
            filter.addEventListener('input', () => this.applyFilters());
          }
        });

        // Adiciona o evento de clique no botão
        clearFiltersBtn.addEventListener('click', () => this.clearFilters());

        this.showAllCards();
      }

      clearFilters() {
        // Limpa o valor de cada campo do formulário de filtros
        document.getElementById('f-status').value = '';
        document.getElementById('f-endereco').value = '';
        document.getElementById('f-tipo').value = '';
        document.getElementById('f-data-inicio').value = '';
        document.getElementById('f-data-fim').value = '';

        // Esconde a mensagem de "nenhum resultado"
        document.getElementById('no-results-message').style.display = 'none';

        // Reexibe todos os cards
        this.showAllCards();
      }

      showAllCards() {
        const cards = document.querySelectorAll('.card');
        cards.forEach((card) => {
          card.style.display = 'grid';
        });
      }

      loadExistingComplaints() {
        console.log('Carregando reclamações existentes...');
        // Carrega as reclamações existentes dos cards HTML
        const existingCards = document.querySelectorAll('.card');
        console.log('Cards encontrados:', existingCards.length);

        existingCards.forEach((card, index) => {
          const id = parseInt(card.dataset.id);
          const status = card.dataset.status;
          const tipo = card.dataset.tipo;
          const endereco = card.dataset.endereco;
          const data = card.dataset.data;
          const hora = card.dataset.hora;
          const descricao = card.dataset.descricao;
          const numero = card.dataset.numero;
          const complemento = card.dataset.complemento;

          this.complaints.push({
            id,
            status,
            tipo,
            endereco,
            data,
            hora,
            descricao,
            numero,
            complemento
          });

          console.log(`Card ${index + 1} carregado: ID ${id}, Status: ${status}, Tipo: ${tipo}`);
        });
      }

      setupStatusForm() {
        console.log('Configurando formulário de status...');
        const form = document.getElementById('status-form');
        if (form) {
          form.addEventListener('submit', (e) => {
            e.preventDefault();
            console.log('Formulário de status submetido');
            this.submitStatusUpdate();
          });
          console.log('Formulário de status configurado com sucesso');
        } else {
          console.error('Formulário de status não encontrado!');
        }
      }

      applyFilters() {
        const statusFilter = document.getElementById('f-status').value;
        const enderecoFilter = document.getElementById('f-endereco').value.toLowerCase();
        const tipoFilter = document.getElementById('f-tipo').value;
        const dataInicioFilter = document.getElementById('f-data-inicio').value;
        const dataFimFilter = document.getElementById('f-data-fim').value;

        const cards = document.querySelectorAll('.card');
        let visibleCardsCount = 0;

        // Parse das datas do filtro fora do loop para melhor performance
        const inicioDate = dataInicioFilter ? new Date(`${dataInicioFilter}T00:00:00`) : null;
        const fimDate = dataFimFilter ? new Date(`${dataFimFilter}T00:00:00`) : null;

        cards.forEach(card => {
          let show = true;
          const status = card.dataset.status;
          const tipo = card.querySelector('.card__col:first-child .value').textContent;
          const endereco = card.querySelector('.card__col:nth-child(2) .value').textContent.toLowerCase();
          const dataTexto = card.querySelector('.card__col:nth-child(3) .value').textContent;

          // Filtro por status
          if (statusFilter && status !== statusFilter) {
            show = false;
          }
          
          // Filtro por endereço
          if (enderecoFilter && !endereco.includes(enderecoFilter)) {
            show = false;
          }
          
          // Filtro por tipo
          if (tipoFilter && tipo !== tipoFilter) {
            show = false;
          }
          
          // --- LÓGICA DE DATA CORRIGIDA ---
          // Só executa o filtro de data se o card ainda estiver visível
          if (show && (inicioDate || fimDate)) {
            // Converte a data do card (DD/MM/AAAA) para um objeto Date confiável
            const [dia, mes, ano] = dataTexto.split('/');
            const cardDate = new Date(ano, mes - 1, dia); // Mês é 0-indexado (0-11)

            // Compara com a data de início
            if (inicioDate && cardDate < inicioDate) {
              show = false;
            }

            // Compara com a data de fim (de forma inclusiva)
            if (fimDate && cardDate > fimDate) {
              show = false;
            }
          }

          card.style.display = show ? 'grid' : 'none';
          if (show) {
            visibleCardsCount++;
          }
        });
        
    

        const noResultsMessage = document.getElementById('no-results-message');
        if (visibleCardsCount === 0) {
          noResultsMessage.style.display = 'block';
        } else {
          noResultsMessage.style.display = 'none';
        }
      }

      updateComplaintStatus(id, newStatus, notes = '') {
        const complaint = this.complaints.find(c => c.id === id);
        if (complaint) {
          complaint.status = newStatus;
          complaint.notes = notes;
          complaint.lastUpdate = new Date().toLocaleString('pt-BR');

          // Atualiza o card visual
          this.updateCardStatus(id, newStatus);

          // Aqui você pode implementar a sincronização com o banco de dados
          console.log(`Status atualizado para ID ${id}: ${newStatus}`);

          return true;
        }
        return false;
      }

      updateCardStatus(id, newStatus) {
        const card = document.querySelector(`[data-id="${id}"]`);
        if (card) {
          // Atualiza o dataset
          card.dataset.status = newStatus;

          // Atualiza o ícone e texto
          const statusIcon = card.querySelector('.status__icon');
          const statusText = card.querySelector('.status__text');

          if (statusIcon && statusText) {
            // Remove classes antigas
            statusText.className = 'status__text';

            // Atualiza ícone e texto baseado no novo status
            switch (newStatus) {
              case 'recebido':
                statusIcon.src = '../img/checkRecebido.png';
                statusIcon.alt = 'Recebido';
                statusText.textContent = 'Recebido';
                statusText.classList.add('status--recebido');
                break;
              case 'andamento':
                statusIcon.src = '../img/checkEmAndamento.png';
                statusIcon.alt = 'Em andamento';
                statusText.textContent = 'Em andamento';
                statusText.classList.add('status--andamento');
                break;
              case 'resolvido':
                statusIcon.src = '../img/checkResolvido.png';
                statusIcon.alt = 'Resolvido';
                statusText.textContent = 'Resolvido';
                statusText.classList.add('status--resolvido');
                break;
            }
          }
        }
      }

      getComplaintDetails(id) {
        return this.complaints.find(c => c.id === id);
      }

      submitStatusUpdate() {
        console.log('submitStatusUpdate chamado na classe');
        console.log('this.currentComplaintId:', this.currentComplaintId);

        if (!this.currentComplaintId) {
          console.error('Nenhuma reclamação selecionada para atualização');
          showSuccessMessage('Erro: Nenhuma reclamação selecionada', 'error');
          return;
        }

        const newStatusElement = document.getElementById('new-status');
        const notesElement = document.getElementById('status-notes');

        if (!newStatusElement) {
          console.error('Elemento new-status não encontrado');
          return;
        }

        if (!notesElement) {
          console.error('Elemento status-notes não encontrado');
          return;
        }

        const newStatus = newStatusElement.value;
        const notes = notesElement.value;

        console.log('Novo status:', newStatus);
        console.log('Observações:', notes);

        if (this.updateComplaintStatus(this.currentComplaintId, newStatus, notes)) {
          showSuccessMessage(`Status atualizado para: ${newStatus}`);
          closeStatusModal();

          // Se o modal de detalhes estiver aberto, atualiza ele também
          const detailsModal = document.getElementById('details-modal');
          if (detailsModal && detailsModal.style.display === 'block') {
            const complaint = this.getComplaintDetails(this.currentComplaintId);
            showDetailsModal(complaint);
          }
        } else {
          console.error('Falha ao atualizar status');
          showSuccessMessage('Erro ao atualizar status', 'error');
        }
      }
    }

    // Variáveis globais
    let adminManager;
    let currentComplaintId = null;

    // Funções para interação com modais
    function viewDetails(id) {
      const complaint = adminManager.getComplaintDetails(id);
      if (complaint) {
        currentComplaintId = id;
        showDetailsModal(complaint);
      }
    }

    function showDetailsModal(complaint) {
      const modal = document.getElementById('details-modal');
      const modalBody = document.getElementById('modal-body');
      const modalTitle = document.getElementById('modal-title');

      modalTitle.textContent = `Reclamação #${complaint.id}`;

      modalBody.innerHTML = `
        <div class="details-grid">
          <div class="detail-item">
            <span class="detail-label">Status:</span>
            <span class="detail-value status--${complaint.status}">${complaint.status}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Tipo:</span>
            <span class="detail-value">${complaint.tipo}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Endereço:</span>
            <span class="detail-value">${complaint.endereco}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Número:</span>
            <span class="detail-value">${complaint.numero}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Complemento:</span>
            <span class="detail-value">${complaint.complemento || 'Não informado'}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Data:</span>
            <span class="detail-value">${complaint.data}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Hora:</span>
            <span class="detail-value">${complaint.hora}</span>
          </div>
          <div class="detail-item detail-item--full">
            <span class="detail-label">Descrição:</span>
            <span class="detail-value">${complaint.descricao}</span>
          </div>
          ${complaint.notes ? `
          <div class="detail-item detail-item--full">
            <span class="detail-label">Observações:</span>
            <span class="detail-value">${complaint.notes}</span>
          </div>
          ` : ''}
          ${complaint.lastUpdate ? `
          <div class="detail-item detail-item--full">
            <span class="detail-label">Última atualização:</span>
            <span class="detail-value">${complaint.lastUpdate}</span>
          </div>
          ` : ''}
        </div>
        <div class="modal__actions">
          <button class="btn btn--secondary" onclick="updateStatus(${complaint.id})">Atualizar Status</button>
          <button class="btn btn--ghost" onclick="closeModal()">Fechar</button>
        </div>
      `;

      modal.style.display = 'block';
    }

    function updateStatus(id) {
      console.log('updateStatus chamado com ID:', id);
      currentComplaintId = id;
      adminManager.currentComplaintId = id; // Atualiza também na classe

      const complaint = adminManager.getComplaintDetails(id);
      console.log('Reclamação encontrada:', complaint);

      if (complaint) {
        const statusSelect = document.getElementById('new-status');
        if (statusSelect) {
          statusSelect.value = complaint.status;
          console.log('Status atual definido como:', complaint.status);
        } else {
          console.error('Elemento new-status não encontrado');
        }

        const statusModal = document.getElementById('status-modal');
        const detailsModal = document.getElementById('details-modal');

        if (statusModal && detailsModal) {
          statusModal.style.display = 'block';
          detailsModal.style.display = 'none';
          console.log('Modal de status aberto');
        } else {
          console.error('Modais não encontrados');
        }
      } else {
        console.error('Reclamação não encontrada para ID:', id);
      }
    }

    function closeModal() {
      const detailsModal = document.getElementById('details-modal');
      if (detailsModal) {
        detailsModal.style.display = 'none';
        console.log('Modal de detalhes fechado');
      }
    }

    function closeStatusModal() {
      const statusModal = document.getElementById('status-modal');
      const form = document.getElementById('status-form');

      if (statusModal) {
        statusModal.style.display = 'none';
        console.log('Modal de status fechado');
      }

      if (form) {
        form.reset();
        console.log('Formulário resetado');
      }
    }

    function submitStatusUpdate() {
      console.log('submitStatusUpdate chamado');
      console.log('currentComplaintId:', currentComplaintId);
      console.log('adminManager.currentComplaintId:', adminManager.currentComplaintId);

      // Chama o método da classe AdminComplaintManager
      adminManager.submitStatusUpdate();
    }

    function showSuccessMessage(message, type = 'success') {
      const successMsg = document.createElement('div');
      successMsg.className = 'success-message';
      successMsg.textContent = message;

      const bgColor = type === 'error' ? '#d32f2f' : '#179800';
      const icon = type === 'error' ? '❌' : '✅';

      successMsg.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${bgColor};
        color: white;
        padding: 16px 24px;
        border-radius: 8px;
        font-weight: 600;
        z-index: 1000;
        animation: slideIn 0.3s ease-out;
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      `;

      successMsg.innerHTML = `${icon} ${message}`;

      document.body.appendChild(successMsg);

      setTimeout(() => {
        successMsg.style.animation = 'slideOut 0.3s ease-in';
        setTimeout(() => successMsg.remove(), 300);
      }, 4000);
    }

    // Fechar modais ao clicar fora
    window.onclick = function (event) {
      const detailsModal = document.getElementById('details-modal');
      const statusModal = document.getElementById('status-modal');

      if (event.target === detailsModal) {
        closeModal();
      }
      if (event.target === statusModal) {
        closeStatusModal();
      }
    }

    // Inicializa quando a página carregar
    document.addEventListener('DOMContentLoaded', () => {
      console.log('DOM carregado, inicializando sistema...');

      // Verifica se todos os elementos necessários estão presentes
      const requiredElements = [
        'details-modal',
        'status-modal',
        'status-form',
        'new-status',
        'status-notes'
      ];

      const missingElements = requiredElements.filter(id => !document.getElementById(id));

      if (missingElements.length > 0) {
        console.error('Elementos faltando:', missingElements);
        alert('Erro: Alguns elementos necessários não foram encontrados. Verifique o console para mais detalhes.');
        return;
      }

      console.log('Todos os elementos necessários encontrados');

      try {
        adminManager = new AdminComplaintManager();
        console.log('Sistema inicializado com sucesso');
      } catch (error) {
        console.error('Erro ao inicializar sistema:', error);
        alert('Erro ao inicializar o sistema. Verifique o console para mais detalhes.');
      }
    });

    // Adiciona estilos CSS para as animações
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      
      @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>

</html>